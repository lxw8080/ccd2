#!/bin/bash

# å®¢æˆ·èµ„æ–™æ”¶é›†ç³»ç»Ÿ - å¯åŠ¨è„šæœ¬

echo "ğŸš€ å®¢æˆ·èµ„æ–™æ”¶é›†ç³»ç»Ÿ - å¯åŠ¨è„šæœ¬"
echo "================================"
echo ""

# æ£€æŸ¥Dockeræ˜¯å¦å®‰è£…
if ! command -v docker &> /dev/null; then
    echo "âŒ Dockeræœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…Docker"
    exit 1
fi

if ! command -v docker-compose &> /dev/null; then
    echo "âŒ Docker Composeæœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…Docker Compose"
    exit 1
fi

echo "âœ… Dockerç¯å¢ƒæ£€æŸ¥é€šè¿‡"
echo ""

# æ£€æŸ¥.envæ–‡ä»¶
if [ ! -f "backend/.env" ]; then
    echo "ğŸ“ åˆ›å»ºåç«¯ç¯å¢ƒå˜é‡æ–‡ä»¶..."
    cp backend/.env.example backend/.env
    echo "âœ… å·²åˆ›å»º backend/.envï¼Œè¯·æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®"
fi

if [ ! -f "frontend/.env" ]; then
    echo "ğŸ“ åˆ›å»ºå‰ç«¯ç¯å¢ƒå˜é‡æ–‡ä»¶..."
    cp frontend/.env.example frontend/.env
    echo "âœ… å·²åˆ›å»º frontend/.env"
fi

echo ""
echo "ğŸ³ å¯åŠ¨Dockerå®¹å™¨..."
docker-compose up -d

echo ""
echo "â³ ç­‰å¾…æœåŠ¡å¯åŠ¨..."
sleep 5

echo ""
echo "âœ… æœåŠ¡å¯åŠ¨å®Œæˆï¼"
echo ""
echo "ğŸ“ è®¿é—®åœ°å€ï¼š"
echo "   å‰ç«¯åº”ç”¨: http://localhost:5173"
echo "   åç«¯API:  http://localhost:8000"
echo "   APIæ–‡æ¡£:  http://localhost:8000/docs"
echo ""
echo "ğŸ“Š æŸ¥çœ‹æ—¥å¿—ï¼š"
echo "   docker-compose logs -f"
echo ""
echo "ğŸ›‘ åœæ­¢æœåŠ¡ï¼š"
echo "   docker-compose down"
echo ""

